---
const images = [
    { src: "/uno.webp", alt: "Evento en Sky - Vista 1" },
    { src: "/dos.webp", alt: "Evento en Sky - Vista 2" },
    { src: "/tres.webp", alt: "Evento en Sky - Vista 3" },
];
---

<section class="bg-neutral-950 py-24 text-white overflow-hidden">
    <div class="max-w-7xl mx-auto px-6 mb-12">
        <h2 class="text-4xl md:text-5xl font-bold tracking-tight">
            Nuestra Galería
        </h2>
        <p class="mt-4 text-neutral-400 text-lg">
            Desliza para explorar los mejores momentos en nuestro jardín.
        </p>
    </div>

    <!-- Contenedor de Scroll Horizontal -->
    <div
        class="flex gap-6 overflow-x-auto px-6 pb-8 snap-x snap-mandatory no-scrollbar cursor-grab active:cursor-grabbing"
        id="gallery-container"
    >
        {
            images.map((image) => (
                <div class="flex-none w-[85vw] md:w-[60vw] lg:w-[40vw] aspect-[16/9] snap-center">
                    <div class="relative w-full h-full rounded-3xl overflow-hidden group border border-neutral-800 transition-all hover:border-white/20">
                        <img
                            src={image.src}
                            alt={image.alt}
                            class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 cursor-zoom-in"
                            data-zoom
                        />
                        <div class="absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity flex items-end p-8 pointer-events-none">
                            <span class="text-sm font-medium tracking-wider uppercase">
                                Ver en grande
                            </span>
                        </div>
                    </div>
                </div>
            ))
        }
    </div>

    <!-- Modal de Zoom (Lightbox) -->
    <dialog
        id="zoom-modal"
        class="bg-transparent backdrop:bg-black/90 p-0 max-w-none max-h-none outline-none border-none"
    >
        <div
            class="relative w-screen h-screen flex items-center justify-center p-4 md:p-12"
        >
            <button
                id="close-modal"
                class="absolute top-6 right-6 text-white hover:text-neutral-400 transition-colors z-50"
            >
                <svg
                    xmlns="http://www.w3.org/2000/svg"
                    class="w-10 h-10"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    ><path d="M18 6 6 18M6 6l12 12"></path></svg
                >
            </button>
            <img
                id="modal-image"
                src=""
                alt=""
                class="max-w-full max-h-full object-contain rounded-xl shadow-2xl animate-in zoom-in duration-300"
            />
        </div>
    </dialog>
</section>

<style>
    /* Ocultar scrollbar pero mantener funcionalidad */
    .no-scrollbar::-webkit-scrollbar {
        display: none;
    }
    .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
    }
</style>

<script>
    const modal = document.querySelector("#zoom-modal") as HTMLDialogElement;
    const modalImg = document.querySelector("#modal-image") as HTMLImageElement;
    const closeBtn = document.querySelector("#close-modal");
    const zoomImages = document.querySelectorAll("[data-zoom]");

    zoomImages.forEach((img) => {
        img.addEventListener("click", () => {
            const src = (img as HTMLImageElement).src;
            const alt = (img as HTMLImageElement).alt;
            modalImg.src = src;
            modalImg.alt = alt;
            modal.showModal();
            document.body.style.overflow = "hidden";
        });
    });

    closeBtn?.addEventListener("click", () => {
        modal.close();
        document.body.style.overflow = "auto";
    });

    // Cerrar al hacer click fuera de la imagen
    modal?.addEventListener("click", (e) => {
        if (e.target === modal) {
            modal.close();
            document.body.style.overflow = "auto";
        }
    });

    // Soporte para arrastre con el mouse (click and drag)
    const container = document.querySelector(
        "#gallery-container",
    ) as HTMLElement;
    let isDown = false;
    let startX: number;
    let scrollLeft: number;

    container?.addEventListener("mousedown", (e) => {
        isDown = true;
        startX = e.pageX - container.offsetLeft;
        scrollLeft = container.scrollLeft;
    });
    container?.addEventListener("mouseleave", () => (isDown = false));
    container?.addEventListener("mouseup", () => (isDown = false));
    container?.addEventListener("mousemove", (e) => {
        if (!isDown) return;
        e.preventDefault();
        const x = e.pageX - container.offsetLeft;
        const walk = (x - startX) * 2;
        container.scrollLeft = scrollLeft - walk;
    });
</script>
